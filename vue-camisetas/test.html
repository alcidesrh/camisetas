<script>
    var token;
    fetch('http://camiseteando.es/endpoint/login', {// loguearse
        headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json',
        },
        method: 'POST',
        body: JSON.stringify({username: 'admin', password: 'admin'})
    })
        .then(response => {
            return response.json();
        })
        .then(response => {
            token = response.token;
            fetch('http://camiseteando.es/endpoint/feria', {//chequear si hay feria/pedido/stock asignado al usuario
                method: 'GET',
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer '+token
                },
            })
                .then(response => {
                    return response.json();
                })
                .then(response => {
                    console.log(response);
                    fetch('http://camiseteando.es/endpoint/update-talla', {//actualizar ventas de tallas
                        method: 'POST',
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json',
                            'Authorization': 'Bearer '+token
                        },
                        body: JSON.stringify([{id: 351, vendida: 1}, {id: 352, vendida: 1}, {id: 353, vendida: 1}])
                    })
                        .then(response => {
                            return response.json();
                        })
                        .then(response => {
                            console.log(response);
                        }).catch(e => {
                        console.log(e);
                    });
                }).catch(e => {
                console.log(e);
            });
        }).catch(e => {
        console.log(e);
    });
</script>